<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rigged Web Spinner</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; background: #f0f2f5; height: 100vh; margin: 0; padding-top: 50px; }
        
        /* About Button (Top Right) */
        #about-btn { position: absolute; top: 10px; right: 10px; padding: 5px 10px; font-size: 12px; cursor: pointer; opacity: 0.6; }
        #about-btn:hover { opacity: 1; }

        .container { text-align: center; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        #canvas { margin: 20px 0; border: 5px solid #333; border-radius: 50%; }
        
        .controls { margin-bottom: 20px; }
        input { padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        button { padding: 8px 15px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; }
        button:hover { background: #0056b3; }
        
        #spin-btn { font-size: 1.2rem; padding: 10px 30px; background: #28a745; margin-top: 10px; }
        
        /* The Pointer Arrow */
        .pointer { width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid red; position: relative; margin-bottom: -15px; z-index: 10; }
    </style>
</head>
<body>

    <button id="about-btn">About</button>

    <div class="container">
        <h2>Custom Spinner</h2>
        <div class="controls">
            <input type="text" id="item-input" placeholder="Add value (e.g. Pizza)">
            <button onclick="addItem()">Add</button>
        </div>
        
        <div class="pointer"></div>
        <canvas id="canvas" width="400" height="400"></canvas>
        <br>
        <button id="spin-btn" onclick="spinWheel()">SPIN!</button>
        <p id="result-text"></p>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const aboutBtn = document.getElementById('about-btn');
        
        let items = ["Yes", "No", "Maybe"];
        let currentRotation = 0;
        let riggedTarget = null;

        function drawWheel() {
            const size = canvas.width;
            const center = size / 2;
            const radius = center - 10;
            const sliceAngle = (2 * Math.PI) / items.length;

            ctx.clearRect(0, 0, size, size);

            items.forEach((item, i) => {
                const angle = i * sliceAngle;
                
                // Draw Slice
                ctx.beginPath();
                ctx.fillStyle = `hsl(${(i * 360) / items.length}, 70%, 60%)`;
                ctx.moveTo(center, center);
                ctx.arc(center, center, radius, angle, angle + sliceAngle);
                ctx.fill();
                ctx.stroke();

                // Draw Text
                ctx.save();
                ctx.translate(center, center);
                ctx.rotate(angle + sliceAngle / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "white";
                ctx.font = "bold 16px sans-serif";
                ctx.fillText(item, radius - 20, 5);
                ctx.restore();
            });
        }

        function addItem() {
            const input = document.getElementById('item-input');
            if (input.value.trim()) {
                items.push(input.value.trim());
                input.value = "";
                drawWheel();
            }
        }

        // The "Secret" Menu
        aboutBtn.addEventListener('click', () => {
            const list = items.map((item, index) => `${index}: ${item}`).join("\n");
            const choice = prompt(`Select the winning index (0 to ${items.length - 1}):\n\n${list}`);
            if (choice !== null && items[choice]) {
                riggedTarget = parseInt(choice);
                alert(`Spinner rigged to: ${items[riggedTarget]}`);
            }
        });

        function spinWheel() {
            const spinBtn = document.getElementById('spin-btn');
            spinBtn.disabled = true;

            const extraSpins = 5 + Math.random() * 5; // 5-10 full rotations
            const sliceAngle = 360 / items.length;
            
            let targetDegree;

            if (riggedTarget !== null) {
                // Calculate degree to land on rigged index
                // Note: Canvas draws 0 degrees at 3 o'clock, pointer is at 12 o'clock (270 deg)
                const targetOffset = (riggedTarget * sliceAngle) + (sliceAngle / 2);
                targetDegree = 270 - targetOffset; 
                riggedTarget = null; // Reset after one use
            } else {
                targetDegree = Math.random() * 360;
            }

            const totalRotation = currentRotation + (extraSpins * 360) + targetDegree;
            
            canvas.style.transition = "transform 4s cubic-bezier(0.15, 0, 0.15, 1)";
            canvas.style.transform = `rotate(${totalRotation}deg)`;

            currentRotation = totalRotation;

            setTimeout(() => {
                spinBtn.disabled = false;
            }, 4000);
        }

        drawWheel();
    </script>
</body>
</html>
